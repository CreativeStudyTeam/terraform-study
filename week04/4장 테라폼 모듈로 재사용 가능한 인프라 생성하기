# 4ì¥ í…Œë¼í¼ ëª¨ë“ˆë¡œ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì¸í”„ë¼ ìƒì„±í•˜ê¸°

> ì§€ë‚œ 3ì¥ì—ì„œ...
> ìƒíƒœê´€ë¦¬ - S3 ë°±ì—”ë“œë¡œ ìƒíƒœë¥¼ ê´€ë¦¬í•œë‹¤.

3ì¥ì—ì„œ ë§Œë“  ë¡œë“œë°¸ëŸ°ì„œ, ì›¬ ì„œë²„ í´ëŸ¬ìŠ¤í„°, ë°ì´í„°ë² ì´ìŠ¤ ì•„í‚¤í…ì²˜

ğŸ‘‰ ì¼ë°˜ì ìœ¼ë¡œ ë‘˜ ì´ìƒì˜ í™˜ê²½ì´ í•„ìš” ( ìŠ¤í…Œì´ì§• / í”„ë¡œë•ì…˜ )

( ë¹„ìš©ì ˆê°ì„ ìœ„í•´ ìŠ¤í…Œì´ì§•ì€ ë” ì ì€ ë¦¬ì†ŒìŠ¤ë¡œ í…ŒìŠ¤íŠ¸ )

---

- 3ì¥ ê²°ê³¼ë¬¼ì„ ëª¨ë“ˆí™”
ğŸ‘‰ modules/services/webserver-cluster/main.ts
- ê° í™˜ê²½ì—ì„œ í•´ë‹¹ ëª¨ë“ˆì„ ì‚¬ìš© ê°€ëŠ¥
ğŸ‘‰ stage/services/webserver-cluster/main.ts
ğŸ‘‰ prod/services/webserver-cluster/main.ts

**ëª¨ë“ˆ**
- ì¬ì‚¬ìš© ê°€ëŠ¥
- ìœ ì§€ ê´€ë¦¬
- í…ŒìŠ¤íŠ¸

---

## 4-1. ëª¨ë“ˆì˜ ê¸°ë³¸

![image](https://user-images.githubusercontent.com/33514304/132936451-c5698558-595a-40f9-a1bd-e0c1dfc604fa.png)

---

## 4-1 ëª¨ë“ˆì˜ ê¸°ë³¸

```terraform
module "<NAME" {
  source = "<SOURCE>"
  
  [CONFIGURE ...]
}
```

![image](https://user-images.githubusercontent.com/33514304/132936428-d94001d6-97f6-40db-bdac-3096cc6b17dc.png)

---


## 4-1 ëª¨ë“ˆì˜ ê¸°ë³¸

ëª¨ë“ˆ ë³€ê²½ ë° ì¶”ê°€ì‹œ ë§¤ë²ˆ `terraform init` í•„ìˆ˜

### terraform init í•˜ëŠ”ì¼
- module ë‹¤ìš´ë¡œë“œ
- ë°±ì—”ë“œ êµ¬ì„±
- provider plugins êµ¬ì„±


---

## 4-2 ëª¨ë“ˆ ì…ë ¥

ë£¨ë¹„ ê¸°ë°˜ì˜ í…Œë¼í¼
- í•¨ìˆ˜ì— ë§¤ê°œë³€ìˆ˜ ë„£ë“¯ì´ ëª¨ë“ˆì—ë„ ë§¤ê°œë³€ìˆ˜ ì‚¬ìš© ê°€ëŠ¥

![width:900px](https://user-images.githubusercontent.com/33514304/132936537-267dc55e-e699-4d4d-9424-e612a5f319eb.png)
![width:900px](https://user-images.githubusercontent.com/33514304/132936551-8f538636-fec2-4606-9eee-9ae76f39ed75.png)

---

## 4-2 ëª¨ë“ˆ ì…ë ¥

í´ëŸ¬ìŠ¤í„°ì˜ ì¸ìŠ¤í„´ìŠ¤ max, min sizeë„ ì™¸ë¶€ ì¸ì ì‚¬ìš©ê°€ëŠ¥
(í™˜ê²½ë§ˆë‹¤ ë‹¤ë¥´ê²Œ)

![image](https://user-images.githubusercontent.com/33514304/132936604-b78916e6-9b47-423c-9ad6-6532dc76aa89.png)

---

## 4-3 ëª¨ë“ˆê³¼ ì§€ì—­ë³€ìˆ˜

í•˜ë“œì½”ë”© ë˜ì–´ìˆëŠ” ë³´ì•ˆ ê·¸ë£¹ì˜ ingress, egress ë¥¼ localì„ í™œìš©í•˜ì—¬ ê°œì„ 

ğŸ‘‰ ì™œ êµ³ì´ localë¡œ? ğŸ™‹â€â™‚ï¸ ì™¸ë¶€ì—ì„œ ì‹¤ìˆ˜ë¡œ ë°”ê¾¸ì§€ ëª»í•˜ê²Œ...ì€ë‹‰! ìº¡ìŠí™”!

![image](https://user-images.githubusercontent.com/33514304/132936663-d48f2abf-514f-4d9f-abec-9fad5d69ca65.png)

---

## 4-4 ëª¨ë“ˆ ì¶œë ¥ (scheduled actions)

í•¨ìˆ˜ë¡œ ì¹˜ë©´ ë°˜í™˜ê°’! ë§ˆì¹˜ ë°˜í™˜ê°’ ì²˜ëŸ¼ ì´ìš©í•  ìˆ˜ ìˆëŠ” output

![image](https://user-images.githubusercontent.com/33514304/132936801-68ca2732-87c0-4e62-a520-58b1adb3c003.png)

![image](https://user-images.githubusercontent.com/33514304/132936728-edc33533-fd61-40c4-b248-4b226cba460d.png)

- ëª¨ë“ˆ ì¶œë ¥ í™œìš© `autoscaling_group_name = module.webserver_cluster.asg_name`

---

## 4-5 ëª¨ë“ˆ ì£¼ì˜ì‚¬í•­

- íŒŒì¼ ê²½ë¡œ

- ë¯¸ë¦¬ ì •ì˜ëœ path ì˜ˆì•½ì–´
  - path.module: ëª¨ë“ˆì˜ ê²½ë¡œë¥¼ ë°˜í™˜
  - path.root: ë£¨íŠ¸ ëª¨ë“ˆì˜ ê²½ë¡œë¥¼ ë°˜í™˜
  - path.cwd: í˜„ì¬ ì‘ì—… ì¤‘ì¸ ë””ë ‰í† ë¦¬ ê²½ë¡œ ë°˜í™˜

![image](https://user-images.githubusercontent.com/33514304/132936892-96509e9d-bf1d-4e9e-8fd6-082792183530.png)

---

## 4-5 ëª¨ë“ˆ ì£¼ì˜ì‚¬í•­

- ì¸ë¼ì¸ ë¸”ë¡

ë³„ë„ì˜ ë¦¬ì†ŒìŠ¤ vs ì¸ë¼ì¸ ë¸”ë¡

ì €ì: ì¸ë¼ì¸ ë¸”ë¡ë³´ë‹¤ ë³„ë„ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì“°ëŠ”ê²Œ í•­ìƒ ì¢‹ë‹¤.
ğŸ‘‰ ëª¨ë“ˆì˜ ìœ ì—°ì„±ì„ ìœ„í•´, ì™¸ë¶€ì—ì„œ ì¡°ì ˆí•  ìˆ˜ ìˆë„ë¡!

- aws_security_group vs aws_security_group_rule
- aws_route_table vs aws_route
- aws_network_acl vs aws_network_acl_rule

---

ì¸ë¼ì¸ ë¸”ë¡
![image](https://user-images.githubusercontent.com/33514304/132936944-5ae390cc-53bc-4b5d-9493-38992e04cc73.png)
ë³„ë„ì˜ ë¦¬ì†ŒìŠ¤
![image](https://user-images.githubusercontent.com/33514304/132936953-f4beb620-5961-43f6-a2b5-f0145e60a942.png)

---

[ì°¸ê³ ] ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬

ê°™ì€ VPCì—ì„œ ì‘ì—…í•˜ë‹¤ê°€ ì „ì—­ì  ë„¤íŠ¸ì›Œí¬ ì„¤ì •ì´ ë³€ê²½ë˜ë©´ ë³€ê²½í•˜ì§€ ì•Šì€ í…Œë¼í¼ í™˜ê²½ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ğŸ‘‰ VPC ê²©ë¦¬ í•„ìš”
ê·€ì°®ìœ¼ë‹ˆê¹Œ ê³„ì • 2ê°œ ì“°ì...(stageìš© liveìš©)

---

## 4-6 ëª¨ë“ˆ ë²„ì „ ê´€ë¦¬

git íƒœê·¸ ê¸°ëŠ¥ìœ¼ë¡œ ë²„ì „ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŒ

https://github.com/brikis98/terraform-up-and-running-code/tags

![image](https://user-images.githubusercontent.com/33514304/132937027-750e9c23-5f51-4a6c-8b52-3c0ec39391aa.png)


---

# ğŸ§

#### ì €ëŸ° í˜•ì‹ì€ NPMì—ì„œë„ ë´¤ëŠ”ë°,,,,,

ê·¸ëŸ¬ë©´ terraformë„ NPMê³¼ ê°™ì´ ëª¨ë“ˆì„ publicí•˜ê²Œ ì˜¬ë¦´ ìˆ˜ ìˆëŠ” ê³³ì´ ìˆì„ê¹Œ?

---

# WELCOME TO TERRAFORM MODULE

https://registry.terraform.io/

![width:800px](https://user-images.githubusercontent.com/33514304/132937070-3c681437-559c-4f8f-9b2a-5fdda18ddc62.png)
